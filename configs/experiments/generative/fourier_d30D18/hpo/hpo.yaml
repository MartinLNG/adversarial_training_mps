# @package _global_
experiment: hpo

defaults:
  - override /born: d30D18
  - override /dataset: 2Dtoy/moons_4k
  - override /trainer/classification: null
  - override /trainer/generative: default
  - override /trainer/ganstyle: null
  - override /trainer/adversarial: null
  - override /tracking: online
  - override /hydra/sweeper: optuna

trainer:
  generative:
    max_epoch: 500
    batch_size: 256
    patience: 150
    stop_crit: "genloss"
    watch_freq: 2000
    metrics: {"genloss": 1, "acc": 20, "rob": 20, "fid": 50, "viz": 50}
    save: false

tracking:
  seed: 42

hydra:
  sweeper:
    sampler:
      _target_: optuna.samplers.TPESampler
      seed: 42
      n_startup_trials: 10

    direction: minimize
    n_trials: 100
    n_jobs: 1

    params:
      trainer.generative.optimizer.kwargs.lr: tag(log, interval(1e-5, 1e-1))
      trainer.generative.optimizer.kwargs.weight_decay: tag(log, interval(1e-9, 1e-1))
