# @package _global_
experiment: size_hpo

defaults:
  - override /born: fourier/d10D6
  - override /dataset: 2Dtoy/moons_4k
  - override /trainer/classification: null
  - override /trainer/generative: test
  - override /trainer/ganstyle: null
  - override /trainer/adversarial: null
  - override /tracking: online
  - override /hydra/sweeper: optuna

tracking:
  seed: 42
dataset:
  split_seed: 11
  gen_dow_kwargs:
    seed: 25

trainer:
  generative:
    max_epoch: 300
    batch_size: 256
    patience: 300
    stop_crit: "genloss"
    watch_freq: 10000
    save: false
    optimizer:
      name: "adam"
      kwargs:
        lr: 1e-4
        weight_decay: 0.0
    criterion:
      name: "nll"
      kwargs:
        eps: 1e-8
    metrics: {"genloss": 1, "acc": 1}

hydra:
  sweeper:
    study_name: "${experiment}_${dataset.name}"
    sampler:
      _target_: optuna.samplers.TPESampler
      seed: 42
      n_startup_trials: 10
    direction: minimize
    n_trials: 30
    n_jobs: 1
    params:
      trainer.generative.optimizer.kwargs.lr: tag(log, interval(1e-4, 5e-2))
      trainer.generative.optimizer.kwargs.weight_decay: tag(log, interval(1e-9, 1e-1))
