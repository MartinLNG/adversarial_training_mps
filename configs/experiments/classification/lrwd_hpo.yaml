# @package _global_
experiment: lrwdbs_hpo

defaults:
  - override /born: d30D18
  - override /dataset: 2Dtoy/spirals_4k
  - override /trainer/classification: adam500_loss
  - override /trainer/ganstyle: null
  - override /trainer/adversarial: null
  - override /tracking: online

trainer:
  classification:
    save: True
  

hydra:
  sweeper:
    sampler:
      _target_: optuna.samplers.TPESampler
      seed: 42
      n_startup_trials: 10

    direction: minimize  # or maximize
    n_trials: 100
    n_jobs: 1

    params:
      trainer.classification.optimizer.kwargs.lr: tag(log, interval(1e-6, 1e-1))
      trainer.classification.optimizer.kwargs.weight_decay: tag(log, interval(1e-4, 1e-1)
      trainer.classification.batch_size: choice(64, 128, 512)
