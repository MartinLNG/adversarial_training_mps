# @package _global_
# Sanity check experiment: reproduce October results with fixed lr=5e-3
# Sweeps over random seeds (tracking, dataset generation, and split) to verify consistency
experiment: sanity_check

defaults:
  - override /born: fourier/d30D18
  - override /dataset: 2Dtoy/moons_4k
  - override /trainer/classification: adam500_loss
  - override /trainer/ganstyle: null
  - override /trainer/adversarial: null
  - override /tracking: online
  - override /hydra/sweeper: optuna

trainer:
  classification:
    max_epoch: 1000
    patience: 500
    save: True
    optimizer:
      kwargs:
        weight_decay: 0.0
        lr: 5e-3

dataset:
  overwrite: true  # Regenerate dataset for each trial (different seeds)

tracking:
  sampling:
    num_bins: 500
    num_spc: 1000

hydra:
  sweeper:
    study_name: "${experiment}"

    sampler:
      _target_: optuna.samplers.TPESampler
      seed: 42
      n_startup_trials: 10

    direction: minimize
    n_trials: 100
    n_jobs: 1

    params:
      # Vary all seeds for full reproducibility check
      tracking.seed: range(1,100)
      dataset.gen_dow_kwargs.seed: range(1,100)
      dataset.split_seed: range(1,100)
