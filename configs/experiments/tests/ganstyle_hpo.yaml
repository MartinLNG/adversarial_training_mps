# @package _global_
experiment: test_ganstyle_hpo

defaults:
  - override /dataset: test
  - override /trainer/classification: null
  - override /trainer/ganstyle: test
  - override /trainer/adversarial: null
  - override /tracking: test
  - override /hydra/sweeper: optuna  # Enable Optuna, goal determined by stop_crit or similar

trainer:
  classification:
    save: False
  
# provide path or give null
model_path: /mathqi/mnissen/adversarial_training_mps/outputs/models/pretrained/moons_4k_080126.005

  

hydra:
  sweeper:
    sampler:
      _target_: optuna.samplers.TPESampler
      seed: 42
      n_startup_trials: 2

    direction: minimize  # or maximize
    n_trials: 10
    n_jobs: 1

    # Search space
    params:
      trainer.ganstyle.optimizer.kwargs.lr: tag(log, interval(1e-5, 1e-3))
      trainer.ganstyle.optimizer.kwargs.weight_decay: interval(0.0, 0.1)