# @package _global_
experiment: seed_sweep

defaults:
  - override /born: fourier/d4D3
  - override /dataset: 2Dtoy/spirals_4k
  - override /trainer/classification: null
  - override /trainer/adversarial: pgd_at
  - override /trainer/ganstyle: null
  - override /trainer/generative: null
  - override /tracking: online

model_path: outputs/seed_sweep/cls/fourier/d4D3/spirals_4k_1802/14/models/spirals_4k_pre_mps_bd3_fourier4_300adamlr0.01180081547041075wd4.6195476127455985e-05

dataset:
  split_seed: 11
  gen_dow_kwargs:
    seed: 25

tracking:
  seed: 42
  evasion:
    method: "PGD"
    norm: 2
    criterion:
      name: "negative log-likelihood"
      kwargs:
        eps: 1e-8
    strengths: [0.15]
    num_steps: 10
    step_size: null
    random_start: true

trainer:
  adversarial:
    max_epoch: 300
    batch_size: 256
    method: "pgd_at"
    stop_crit: "rob"
    patience: 300
    watch_freq: 1000
    metrics: {"rob": 1, "clsloss": null, "acc": null}

    evasion:
      method: "PGD"
      norm: 2
      criterion:
        name: "negative log-likelihood"
        kwargs:
          eps: 1e-8
      strengths: [0.15]
      num_steps: 10
      step_size: null
      random_start: true

    curriculum: true
    curriculum_start: 0.01
    curriculum_end_epoch: 200

    save: true
    auto_stack: true
    auto_unbind: false

    optimizer:
      kwargs:
        lr: 0.0024820762449519994    # FILL FROM HPO
        weight_decay: 2.9843528783699723e-06  # FILL FROM HPO
    clean_weight: 0.2125892910814501  # FILL FROM HPO

hydra:
  sweeper:
    params:
      tracking.seed: range(1,21)
